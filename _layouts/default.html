<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
   
  <title>{{ page.title }}</title>
  <link rel="shortcut icon" type="image/x-icon" href="{{ '/Images/icon/favicon.ico' | relative_url }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ '/Images/icon/favicon-32x32.png' | relative_url }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ '/Images/icon/favicon-16x16.png' | relative_url }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ '/Images/icon/apple-touch-icon.png' | relative_url }}">
  <link rel="manifest" href="{{ '/Images/icon/site.webmanifest' | relative_url }}">
 
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=JetBrains+Mono&display=swap" rel="stylesheet">
   
  <style>
    /* --- 0. å…¨å±€è®¾ç½® --- */
    .github-only { display: none !important; }
    .lang-zh { display: none; animation: fadeIn 0.5s ease; }
    .lang-en { display: block; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
   
    body { 
      margin: 0; padding: 0; color: #e0e7ff; 
      font-family: 'Inter', -apple-system, sans-serif; 
      line-height: 1.6; overflow-x: hidden; 
      cursor: none; 
      scrollbar-width: thin; scrollbar-color: #3b82f6 transparent;
      transition: color 0.5s ease;
    }
    @media (pointer: coarse) { body { cursor: auto; } }
 
    img, video, iframe { max-width: 100% !important; height: auto !important; box-sizing: border-box; }
 
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(59, 130, 246, 0.5); border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(59, 130, 246, 0.8); }
    ::selection { background: #3b82f6; color: #ffffff; text-shadow: 0 0 8px rgba(255, 255, 255, 0.8); }
 
    /* --- 1. å…‰æ ‡ & è¿›åº¦æ¡ --- */
    .cursor-dot, .cursor-outline {
      position: fixed; top: 0; left: 0; 
      transform: translate(-50%, -50%); border-radius: 50%; z-index: 99999; pointer-events: none;
    }
    .cursor-dot { width: 8px; height: 8px; background-color: #3b82f6; }
    .cursor-outline { 
      width: 40px; height: 40px; border: 1px solid rgba(59, 130, 246, 0.5); 
      transition: width 0.2s, height 0.2s, background-color 0.2s;
    }
    body.hovering .cursor-outline { width: 60px; height: 60px; background-color: rgba(59, 130, 246, 0.1); border-color: transparent; }
 
    #progress-bar {
      position: fixed; top: 0; left: 0; height: 3px;
      background: linear-gradient(90deg, #3b82f6, #60a5fa); 
      width: 0%; z-index: 99999; transition: width 0.1s;
    }
 
    /* --- 2. èƒŒæ™¯ --- */
    #vanta-bg { 
      position: fixed; z-index: -5; top: 0; left: 0; width: 100%; height: 100%; 
      background: #0a0a0f; 
    }
    #vanta-bg::after {
      content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at center, transparent 0%, rgba(10, 10, 15, 0.4) 100%);
      pointer-events: none;
      transition: background 0.5s ease;
    }
 
    /* --- 3. å¸ƒå±€ --- */
    .layout-wrapper {
      position: relative; max-width: 860px; 
      margin: 100px auto 60px; 
      z-index: 10;
      perspective: 1000px;
    }
 
    /* --- 4. æœºå™¨äººæ ¸å¿ƒ --- */
    #bot-container { 
      position: absolute; top: 70px; left: 50%; 
      transform: translateX(-50%); width: 120px; height: 70px; 
      z-index: 9999; cursor: pointer; opacity: 0; 
      animation: botEnter 0.5s ease-out forwards;
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
    }
    #bot-container.fixed-mode {
      position: fixed !important; top: auto !important; left: auto !important;
      bottom: 30px !important; right: 30px !important;
      transform: scale(0.9) !important; opacity: 1 !important;
    }
    
    /* æœºå™¨äººå¼•å¯¼è·³è·ƒåŠ¨ç”» */
    #bot-container.attention-jump {
      animation: attention-bounce 0.6s ease infinite alternate;
    }
    @keyframes attention-bounce {
      0% { transform: translateX(-50%) translateY(0) scale(1); }
      100% { transform: translateX(-50%) translateY(-15px) scale(1.1); }
    }
    #bot-container.fixed-mode.attention-jump {
      animation: attention-bounce-fixed 0.6s ease infinite alternate;
    }
    @keyframes attention-bounce-fixed {
      0% { transform: scale(0.9) translateY(0); }
      100% { transform: scale(0.9) translateY(-15px); }
    }

    /* æ¶Ÿæ¼ªå…‰åœˆ */
    .pulse-ring {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 100px; height: 100px; border-radius: 50%; 
      border: 2px solid rgba(168, 85, 247, 0.5); 
      opacity: 0; z-index: -1; pointer-events: none;
      animation: pulse-ring-anim 6s infinite cubic-bezier(0.4, 0, 0.6, 1);
      transition: opacity 0.5s; 
    }
    #bot-container.speaking .pulse-ring {
      animation-duration: 1.5s;
      border-color: rgba(59, 130, 246, 0.8); 
    }
    
    /* äº’åŠ¨å®Œæˆåéšè—å…‰åœˆ */
    #bot-container.interaction-done .pulse-ring {
      opacity: 0 !important;
      animation: none !important;
    }

    @keyframes pulse-ring-anim { 
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 
      30% { opacity: 0.6; }
      100% { transform: translate(-50%, -50%) scale(2.5); opacity: 0; } 
    }

    .bot-head { width: 100px; height: 50px; background: #ffffff; border: 2px solid #e0e7ff; border-bottom: none; border-radius: 50px 50px 20px 20px; margin: 0 auto; position: relative; box-shadow: 0 -5px 15px rgba(59, 130, 246, 0.15); display: flex; justify-content: center; align-items: center; gap: 10px; padding-top: 5px; animation: float-bot 3s ease-in-out infinite; }
    .bot-eye { width: 28px; height: 28px; background: #bfdbfe; border-radius: 50%; border: 1px solid #93c5fd; position: relative; overflow: hidden; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
    .bot-pupil { width: 14px; height: 14px; background: #1e3a8a; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); transition: opacity 0.2s; }
    .bot-lid { position: absolute; top: 0; left: 0; width: 100%; height: 0%; background: #ffffff; z-index: 10; animation: blink 4s infinite; }
    #bot-container.speaking .bot-eye { background: transparent; border: none; box-shadow: none; width: 22px; height: 12px; border-top: 3px solid #3b82f6; border-radius: 22px 22px 0 0; margin-top: 8px; }
    #bot-container.speaking .bot-pupil, #bot-container.speaking .bot-lid { opacity: 0; }
    .bot-mouth { position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); width: 6px; height: 6px; background: #3b82f6; border-radius: 4px; opacity: 0; transition: all 0.2s; }
    #bot-container.speaking .bot-mouth { opacity: 1; width: 14px; background: transparent; border: 2px solid #3b82f6; animation: mouth-talk 0.25s infinite alternate; }
    .bot-antenna { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); width: 2px; height: 25px; background: #e0e7ff; }
    .bot-antenna::after { content: ''; position: absolute; top: -6px; left: -3px; width: 8px; height: 8px; border-radius: 50%; animation: pulse-antenna-breath 2s infinite ease-in-out; }
 
    /* --- æœºå™¨äººæ°”æ³¡ & å¯¹è¯æ¡† --- */
    #bot-speech {
      position: absolute; top: -45px; left: 50%;
      transform: translateX(-50%) scale(0); transform-origin: bottom center;
      background: rgba(30, 41, 59, 0.95); color: #fff;
      padding: 6px 14px; border-radius: 12px;
      font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; white-space: nowrap; pointer-events: none;
      border: 1px solid rgba(59, 130, 246, 0.4); box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s;
      z-index: 10000; opacity: 0;
    }
    #bot-speech::after {
      content: ''; position: absolute; bottom: -5px; left: 50%;
      width: 8px; height: 8px; background: inherit;
      transform: translateX(-50%) rotate(45deg);
      border-right: 1px solid rgba(59, 130, 246, 0.4); border-bottom: 1px solid rgba(59, 130, 246, 0.4);
    }
    #bot-container.speaking #bot-speech { transform: translateX(-50%) scale(1); opacity: 1; }

    #rpg-dialogue {
      position: absolute; top: 65px; left: 50%;
      transform: translateX(-50%) translateY(20px);
      width: 600px; max-width: 90vw;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid #3b82f6; border-radius: 12px; padding: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6), 0 0 15px rgba(59, 130, 246, 0.2);
      z-index: 20000; opacity: 0; pointer-events: none;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex; flex-direction: column; gap: 10px;
      font-family: 'JetBrains Mono', monospace;
    }
    #rpg-dialogue.active { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }
    #bot-container.fixed-mode #rpg-dialogue { top: auto; bottom: 80px; left: auto; right: 0; transform: translateY(20px); }
    #bot-container.fixed-mode #rpg-dialogue.active { transform: translateY(0); }
    #rpg-text { color: #bfdbfe; font-size: 0.9rem; min-height: 40px; line-height: 1.5; }
    #rpg-cursor { display: inline-block; width: 8px; height: 14px; background: #3b82f6; vertical-align: middle; animation: blink 1s infinite; }
    #rpg-options { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
    .rpg-btn {
      background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: #93c5fd;
      padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; text-align: left;
      transition: all 0.2s; opacity: 0; transform: translateX(-10px); animation: slideIn 0.3s forwards;
    }
    .rpg-btn:hover { background: rgba(59, 130, 246, 0.25); border-color: #60a5fa; color: #fff; transform: translateX(2px); }
    @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
    .rpg-close { position: absolute; top: 5px; right: 8px; font-size: 18px; color: #475569; cursor: pointer; }
    .rpg-close:hover { color: #fff; }

    /* --- å†…å®¹å®¹å™¨ --- */
    .container { 
      position: relative; padding: 60px 80px; 
      background: rgba(255, 255, 255, 0.05); 
      backdrop-filter: blur(20px) saturate(180%); -webkit-backdrop-filter: blur(20px) saturate(180%); 
      border-radius: 20px; box-shadow: 0 20px 50px rgba(59, 130, 246, 0.15); 
      border: 1px solid rgba(255, 255, 255, 0.1); border-top: 4px solid #3b82f6; 
      opacity: 0; animation: fadeUp 0.8s ease-out 0.3s forwards; z-index: 1;
      transform-style: preserve-3d; transition: transform 0.1s ease-out; overflow: hidden; 
    }
    .container::before {
      content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: radial-gradient(800px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(255, 255, 255, 0.07), transparent 40%);
      z-index: -1; pointer-events: none; opacity: 0; transition: opacity 0.5s;
    }
    .container:hover::before { opacity: 1; }
    #main_content table { width: 100% !important; border-collapse: collapse; margin: 20px 0; background: rgba(10, 10, 15, 0.3); border-radius: 8px; overflow: hidden; }
    #main_content th, #main_content td { padding: 12px; border: 1px solid rgba(255, 255, 255, 0.1); }
    #main_content tr:first-child, #main_content thead tr { background: rgba(30, 41, 59, 0.8) !important; }
    #main_content th { color: #60a5fa; font-weight: 600; }
    .typewriter-container { font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; color: #93c5fd; min-height: 1.6em; margin-bottom: 2rem; }
    .typewriter-cursor { animation: blink-cursor 0.8s infinite; border-left: 3px solid #3b82f6; margin-left: 2px; }
    .nav-badges { margin: 2rem 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
    .nav-badges a { opacity: 0; animation: fadeUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; position: relative; z-index: 2; }
    .nav-badges img { height: 28px !important; width: auto; border-radius: 50px; box-shadow: 0 2px 6px rgba(59, 130, 246, 0.15); border: 1.5px solid white; transition: all 0.3s; mix-blend-mode: normal !important; }
    .nav-badges a:hover img { animation: float-hover 2s ease-in-out infinite; box-shadow: 0 8px 20px rgba(59, 130, 246, 0.35); transform: scale(1.1); }
    .nav-badges img.rippling { animation: ripple-wave 0.5s forwards; }
       
    /* --- æŒ‰é’® & æ¨¡å¼ --- */
    .controls-container { position: fixed; top: 20px; right: 20px; display: flex; gap: 15px; z-index: 10000; }
    .ctrl-btn { width: 40px; height: 40px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; backdrop-filter: blur(10px); transition: all 0.3s ease; font-size: 1.2rem; user-select: none; }
    .ctrl-btn:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.1); }
    #lang-toggle { font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; font-weight: bold; width: auto; padding: 0 10px; border-radius: 20px; }

    body.light-mode { color: #1e293b; }
    body.light-mode #vanta-bg::after { background: radial-gradient(circle at center, transparent 0%, rgba(255, 255, 255, 0.6) 100%); }
    body.light-mode .container { background: rgba(255, 255, 255, 0.65); border-color: rgba(0, 0, 0, 0.1); box-shadow: 0 20px 50px rgba(0, 0, 0, 0.05); }
    body.light-mode #rpg-dialogue { background: rgba(255, 255, 255, 0.95); border-color: #cbd5e1; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
    body.light-mode #rpg-text { color: #334155; }
    body.light-mode .rpg-btn { background: rgba(37, 99, 235, 0.1); color: #2563eb; border-color: rgba(37, 99, 235, 0.2); }
    body.light-mode .rpg-btn:hover { background: rgba(37, 99, 235, 0.2); color: #1d4ed8; }
    body.light-mode #bot-speech { background: rgba(255, 255, 255, 0.95); color: #1e293b; border-color: #cbd5e1; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    body.light-mode .typewriter-container { color: #2563eb; }
    body.light-mode #main_content th { color: #2563eb; }
    body.light-mode #main_content td { border-color: rgba(0,0,0,0.1); }
    body.light-mode .rpg-close { color: #94a3b8; }
    body.light-mode .rpg-close:hover { color: #ef4444; }
    body.light-mode .ctrl-btn { background: rgba(0, 0, 0, 0.05); border-color: rgba(0, 0, 0, 0.1); color: #334155; }
    body.light-mode .ctrl-btn:hover { background: rgba(0, 0, 0, 0.1); }
    .img-caption { color: #3b82f6; } 

    @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes float-bot { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
    @keyframes blink { 0%, 48%, 52%, 100% { height: 0%; } 50% { height: 100%; } }
    @keyframes botEnter { from { opacity: 0; transform: translateX(-50%) translateY(20px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }
    @keyframes blink-cursor { from, to { opacity: 1; } 50% { opacity: 0; } }
    @keyframes pulse-antenna-breath { 0%, 100% { background: #3b82f6; box-shadow: 0 0 5px #3b82f6; } 50% { background: #93c5fd; box-shadow: 0 0 15px #60a5fa, 0 0 8px #ffffff; } }
    @keyframes mouth-talk { 0% { height: 2px; } 100% { height: 8px; border-radius: 50%; } }
    
    /* ç§»åŠ¨ç«¯å¼¹çª—ç»å¯¹å±…ä¸­ */
    .welcome-modal {
      position: fixed; inset: 0; 
      background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px);
      z-index: 100001; 
      display: flex; justify-content: center; align-items: center;
      opacity: 0; pointer-events: none; transition: opacity 0.5s ease;
      padding: 20px; 
    }
    .welcome-modal.show { opacity: 1; pointer-events: auto; }
    
    .modal-content {
      background: rgba(30, 41, 59, 0.85); 
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
      padding: 30px; border-radius: 20px; 
      width: 90%; max-width: 400px; text-align: center;
      margin: auto; 
      max-height: 90vh; overflow-y: auto; 
      transform: scale(0.9); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative; /* å…³é”®ï¼šä¸ºå³ä¸‹è§’å¼€å…³å®šä½ */
      padding-bottom: 70px; /* ğŸ”¥ å¢åŠ åº•éƒ¨ paddingï¼Œç»™å¼€å…³ç•™è¶³ç©ºé—´ */
    }
    .welcome-modal.show .modal-content { transform: scale(1); }
    
    .modal-title { font-size: 1.5rem; margin-bottom: 15px; color: #fff; font-weight: 600; }
    .modal-body { font-size: 1rem; color: #cbd5e1; margin-bottom: 25px; line-height: 1.6; }
    
    /* é»˜è®¤éšè—å¼¹çª—å†…çš„ä¸­æ–‡ */
    .m-zh { display: none; }

    .modal-btns { display: flex; flex-direction: column; gap: 10px; }
    .btn-primary, .btn-secondary {
      padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.2s;
      border: none; font-family: inherit;
    }
    .btn-primary { background: #3b82f6; color: white; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
    .btn-primary:hover { background: #2563eb; transform: translateY(-2px); }
    .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #e2e8f0; }
    .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); }

    /* ğŸ”¥ å³ä¸‹è§’è¯­è¨€åˆ‡æ¢å¼€å…³ */
    .modal-lang-switch-container {
      position: absolute; bottom: 20px; right: 25px;
      display: flex; flex-direction: column; align-items: flex-end; /* å³å¯¹é½ */
      gap: 4px;
    }
    .lang-title {
      font-size: 0.7rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;
    }
    .lang-row {
      display: flex; align-items: center; gap: 8px;
      font-size: 0.85rem; color: #cbd5e1; font-family: 'JetBrains Mono', monospace;
    }
    
    /* å¼€å…³æœ¬ä½“æ ·å¼ */
    .switch {
      position: relative; display: inline-block; width: 40px; height: 20px;
    }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider {
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #475569; transition: .4s; border-radius: 20px;
    }
    .slider:before {
      position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px;
      background-color: white; transition: .4s; border-radius: 50%;
    }
    input:checked + .slider { background-color: #3b82f6; }
    input:focus + .slider { box-shadow: 0 0 1px #3b82f6; }
    input:checked + .slider:before { transform: translateX(20px); }

    @media (max-width: 768px) { 
      #bot-speech {
        white-space: normal !important; max-width: 200px !important; width: max-content !important; height: auto !important; line-height: 1.5;
        left: auto !important; right: 0 !important; top: -55px !important; border-radius: 12px 12px 0 12px !important; 
        transform: translateX(0) scale(0) !important; transform-origin: bottom right !important; 
      }
      #bot-container.speaking #bot-speech { transform: translateX(0) scale(1) !important; }
      .cursor-dot, .cursor-outline { display: none; } 
      .layout-wrapper { margin-top: 40px !important; }
      .controls-container { top: 15px; right: 15px; gap: 8px; }
      .ctrl-btn { width: 35px; height: 35px; font-size: 1rem; }
      #lang-toggle { font-size: 0.7rem; padding: 0 8px; }
      #bot-container { 
        display: block !important; position: fixed !important; top: auto !important; left: auto !important;
        right: 20px !important; bottom: 30px !important; transform: scale(0.85) translateX(0) !important;
        opacity: 1 !important; animation: none !important;
      }
      #bot-container #rpg-dialogue {
        position: fixed !important; top: auto !important; bottom: 100px !important; left: 10px !important; right: 10px !important;
        width: auto !important; max-width: none !important; transform: translateY(10px) !important;
      }
      #bot-container #rpg-dialogue.active { transform: translateY(0) !important; }
      .container { padding: 30px 20px; } 
      #main_content { overflow-x: auto; }
    }
  </style>
 </head>
 
 <body>
  <div id="welcome-modal" class="welcome-modal">
    <div class="modal-content">
      
      <div class="modal-title">
        <span class="m-en">ğŸ‘‹ Welcome!</span>
        <span class="m-zh">ğŸ‘‹ æ¬¢è¿è®¿é—®ï¼</span>
      </div>
      
      <div class="modal-body">
        <span class="m-en">
          This website is best viewed in <b>Dark Mode</b>.<br>
          <span style="font-size: 0.85rem; color: #94a3b8;">
            (You can adjust settings anytime at the top-right corner)
          </span>
        </span>
        <span class="m-zh">
          æœ¬ç½‘ç«™ä¸“ä¸º<b>æ·±è‰²æ¨¡å¼</b>è®¾è®¡ï¼Œæ¨èä¿æŒé»˜è®¤è®¾ç½®ã€‚<br>
          <span style="font-size: 0.85rem; color: #94a3b8;">
            (æ‚¨éšæ—¶å¯ä»¥åœ¨å³ä¸Šè§’åˆ‡æ¢è¯­è¨€å’Œä¸»é¢˜)
          </span>
        </span>
      </div>

      <div class="modal-btns">
        <button id="modal-keep-dark-btn" class="btn-primary">
          <span class="m-en">ğŸŒ‘ Keep Dark Mode</span>
          <span class="m-zh">ğŸŒ‘ ä¿æŒæ·±è‰² (æ¨è)</span>
        </button>
        <button id="modal-switch-light-btn" class="btn-secondary">
          <span class="m-en">â˜€ï¸ Switch to Light Mode</span>
          <span class="m-zh">â˜€ï¸ åˆ‡æ¢åˆ°æµ…è‰²</span>
        </button>
      </div>

      <div class="modal-lang-switch-container">
        <span class="lang-title">Language / è¯­è¨€</span>
        <div class="lang-row">
          <span>English</span>
          <label class="switch">
            <input type="checkbox" id="modal-lang-toggle-checkbox">
            <span class="slider round"></span>
          </label>
          <span>ç®€ä½“ä¸­æ–‡</span>
        </div>
      </div>

    </div>
  </div>

  <div class="controls-container">
    <div id="lang-toggle" class="ctrl-btn" title="Switch Language">EN/CN</div>
    <div id="theme-toggle" class="ctrl-btn" title="Switch Theme">â˜€ï¸</div>
  </div>

  <div class="cursor-dot"></div>
  <div class="cursor-outline"></div>
  <div id="progress-bar"></div>
  <div id="vanta-bg"></div>
 
  <div id="bot-container" title="Chat with me!">
    <div class="pulse-ring"></div>
    <div id="bot-speech">System Online.</div>
    <div id="rpg-dialogue">
      <div class="rpg-close">Ã—</div>
      <div><span id="rpg-text">Initializing...</span><span id="rpg-cursor"></span></div>
      <div id="rpg-options"></div>
    </div>
    <div class="bot-antenna"></div>
    <div class="bot-head">
      <div class="bot-eye"><div class="bot-pupil"></div><div class="bot-lid"></div></div>
      <div class="bot-eye"><div class="bot-pupil"></div><div class="bot-lid"></div></div>
      <div class="bot-mouth"></div>
    </div>
  </div>
 
  <div class="layout-wrapper">
    <div class="container">
      <section id="main_content">
        {{ content }}
      </section>
 
      <div class="typewriter-container">
        <span id="typewriter-text"></span><span class="typewriter-cursor"></span>
      </div>
 
      <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); text-align: center; color: #94a3b8; font-size: 0.85rem;">
        <p> E-Link â€¢ COPYRIGHT Â© 2026 Tianyu Bai</p>
      </footer>
    </div>
  </div>
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
  <script>
    // --- ğŸŒ åŒè¯­æ•°æ®æº ---
    const dialogData_EN = {
      "start": {
        text: "Hi! I'm the Connector Guardian. I protect your neural interfaces.",
        options: [ { text: "ğŸš€ Let's start!", next: "root_menu" } ]
      },
      "root_menu": {
        text: "Select a category to inspect:",
        options: [
          { text: "ğŸŒŸ What's Special?", next: "innovation" },
          { text: "ğŸ“Š Specifications (Weight/Noise)", next: "specs_menu" },
          { text: "ğŸ›¡ï¸ Reliability & Durability", next: "reliability_menu" },
          { text: "ğŸ”§ Usage & Compatibility", next: "usage_menu" },
          { text: "Just browsing", next: "close" }
        ]
      },
      "innovation": {
        text: "I feature a novel elastomeric interposer. This means NO precise alignment is needed and ZERO insertion force.",
        options: [
          { text: "Why is 'Zero Force' better?", next: "zero_force" },
          { text: "Can it scale up?", next: "scalability" },
          { text: "Back to Menu", next: "root_menu" } 
        ]
      },
      "zero_force": {
        text: "Traditional plugs require high force, risking probe fracture. My threaded cap converts rotation into gentle vertical pressure, protecting delicate films.",
        options: [ { text: "Cool! Back.", next: "innovation" } ]
      },
      "scalability": {
        text: "Yes! The fine-pitch elastomer allows scaling to 1024 channels within the same 25mm footprint. I am future-proof.",
        options: [ { text: "Got it, Back.", next: "innovation" } ]
      },
      "specs_menu": {
        text: "Checking Diagnostics... Which parameter concerns you?",
        options: [
          { text: "Is it heavy? (Weight)", next: "weight" },
          { text: "Does it get hot? (Thermal)", next: "thermal" },
          { text: "How clean is the signal? (Noise)", next: "noise" },
          { text: "Back to Menu", next: "root_menu" }
        ]
      },
      "weight": {
        text: "I am ultra-light. Detached weight is only 2.8g. Even housed, I am 57% lighter (6.6g) than competitors, reducing strain on the animal.",
        options: [ { text: "Good for mice/rats.", next: "specs_menu" } ]
      },
      "thermal": {
        text: "I stay cool. Steady-state temperature is 30.5Â°C, well below the 37Â°C biological threshold. No active cooling required.",
        options: [ { text: "Safe confirmed.", next: "specs_menu" } ]
      },
      "noise": {
        text: "Crystal clear. My noise floor is 2.68 Â± 0.46 ÂµV RMS, matching the theoretical limit of the Intan chips. No signal degradation.",
        options: [ { text: "Great specs.", next: "specs_menu" } ]
      },
      "reliability_menu": {
        text: "I am built to last. What is your concern?",
        options: [
          { text: "Lifespan (Cycles)", next: "cycles" },
          { text: "What if I align it wrong?", next: "misalignment" },
          { text: "Contact Impedance?", next: "impedance" },
          { text: "Back to Menu", next: "root_menu" }
        ]
      },
      "cycles": {
        text: "Verified for 100+ mating cycles with >97% connection yield. The elastomer shows negligible wear.",
        options: [ { text: "Solid.", next: "reliability_menu" } ]
      },
      "misalignment": {
        text: "No problem. The elastomer has 'structural redundancy' (pitch < pad size). Even with radial misalignment, the connection holds.",
        options: [ { text: "Very forgiving.", next: "reliability_menu" } ]
      },
      "impedance": {
        text: "Low and stable. Contact impedance is consistently between 0.3 kÎ© and 0.4 kÎ© across the array.",
        options: [ { text: "Acknowledged.", next: "reliability_menu" } ]
      },
      "usage_menu": {
        text: "Designed for researchers. Ask me about usage:",
        options: [
          { text: "Is assembly difficult?", next: "assembly" },
          { text: "Compatible Systems?", next: "system" },
          { text: "For freely moving animals?", next: "animal" },
          { text: "Back to Menu", next: "root_menu" }
        ]
      },
      "assembly": {
        text: "Easy. No specialized micro-soldering needed. It's a 'plug-and-play' assembly using standard tools.",
        options: [ { text: "User friendly.", next: "usage_menu" } ]
      },
      "system": {
        text: "Fully compatible with the Intan RHD recording system. Supports 64, 128, and 256 channel configurations.",
        options: [ { text: "Perfect.", next: "usage_menu" } ]
      },
      "animal": {
        text: "Yes. The low profile fits mechanical commutators, allowing natural behavior without cable twisting.",
        options: [ { text: "Show me the files!", next: "show_badges" } ]
      },
      "show_badges": {
        text: "Scroll to the bottom! ğŸ‘‡ Those icons are your gateway to the Code, Fabrication Files, and Demo Videos.",
        options: [ { text: "Thanks, Guardian!", next: "close" } ]
      }
    };

    const dialogData_ZH = {
      "start": {
        text: "ä½ å¥½ï¼æˆ‘æ˜¯è¿æ¥å™¨å®ˆæŠ¤è€…ã€‚æˆ‘ä¼šä¿æŠ¤ä½ çš„ç¥ç»æ¥å£ã€‚",
        options: [ { text: "ğŸš€ å¼€å§‹æ¢ç´¢ï¼", next: "root_menu" } ]
      },
      "root_menu": {
        text: "ç³»ç»Ÿå°±ç»ªã€‚è¯·é€‰æ‹©ä½ è¦æŸ¥çœ‹çš„ç±»åˆ«ï¼š",
        options: [
          { text: "ğŸŒŸ æ ¸å¿ƒäº®ç‚¹ (åˆ›æ–°æ€§)", next: "innovation" },
          { text: "ğŸ“Š è§„æ ¼å‚æ•° (é‡é‡/å™ªéŸ³)", next: "specs_menu" },
          { text: "ğŸ›¡ï¸ å¯é æ€§ä¸è€ä¹…åº¦", next: "reliability_menu" },
          { text: "ğŸ”§ ä½¿ç”¨ä¸å…¼å®¹æ€§", next: "usage_menu" },
          { text: "éšä¾¿çœ‹çœ‹", next: "close" }
        ]
      },
      "innovation": {
        text: "æˆ‘é‡‡ç”¨äº†æ–°å‹å¼¹æ€§ä½“äº’è¿æŠ€æœ¯ (Elastomeric Interposer)ã€‚è¿™æ„å‘³ç€æ— éœ€ç²¾ç¡®å¯¹å‡†ï¼Œä¸”å®ç°äº†â€œé›¶æ’å…¥åŠ›â€ã€‚",
        options: [
          { text: "â€œé›¶æ’å…¥åŠ›â€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ", next: "zero_force" },
          { text: "é€šé“æ•°èƒ½æ‰©å±•å—ï¼Ÿ", next: "scalability" },
          { text: "è¿”å›ä¸»èœå•", next: "root_menu" } 
        ]
      },
      "zero_force": {
        text: "ä¼ ç»Ÿæ’å¤´éœ€è¦å¾ˆå¤§çš„åŠ›ï¼Œå®¹æ˜“å¼„æ–­è„†å¼±çš„æ¢é’ˆã€‚æˆ‘çš„èºçº¹ç›–å°†æ—‹è½¬è½¬åŒ–ä¸ºè½»æŸ”çš„å‚ç›´å‹åŠ›ï¼Œå®Œç¾ä¿æŠ¤è–„è†œæ¢é’ˆã€‚",
        options: [ { text: "å¾ˆæ£’çš„è®¾è®¡ï¼è¿”å›ã€‚", next: "innovation" } ]
      },
      "scalability": {
        text: "å½“ç„¶ï¼é«˜å¯†åº¦å¼¹æ€§ä½“å…è®¸åœ¨åŒæ ·çš„ 25mm å°è£…å†…æ‰©å±•è‡³ 1024 é€šé“ã€‚æˆ‘æ˜¯é¢å‘æœªæ¥çš„è®¾è®¡ã€‚",
        options: [ { text: "å°è±¡æ·±åˆ»ã€‚è¿”å›ã€‚", next: "innovation" } ]
      },
      "specs_menu": {
        text: "æ­£åœ¨æ£€æŸ¥è¯Šæ–­æ•°æ®... ä½ å…³å¿ƒå“ªä¸ªå‚æ•°ï¼Ÿ",
        options: [
          { text: "é‡ä¸é‡ï¼Ÿ (é‡é‡)", next: "weight" },
          { text: "å‘çƒ­å—ï¼Ÿ (çƒ­å­¦)", next: "thermal" },
          { text: "ä¿¡å·å¹²å‡€å—ï¼Ÿ (å™ªéŸ³)", next: "noise" },
          { text: "è¿”å›ä¸»èœå•", next: "root_menu" }
        ]
      },
      "weight": {
        text: "æˆ‘éå¸¸è½»ã€‚æ‹†å¸åä»…é‡ 2.8gã€‚å³ä½¿å«å¤–å£³ï¼Œæˆ‘ä¹Ÿæ¯”ç«å“è½» 57% (6.6g)ï¼Œå¤§å¤§å‡è½»äº†åŠ¨ç‰©çš„è´Ÿæ‹…ã€‚",
        options: [ { text: "å¾ˆé€‚åˆå°é¼ /å¤§é¼ ã€‚", next: "specs_menu" } ]
      },
      "thermal": {
        text: "æˆ‘å¾ˆå†·é™ã€‚ç¨³æ€æ¸©åº¦ä»…ä¸º 30.5Â°Cï¼Œè¿œä½äº 37Â°C çš„ç”Ÿç‰©é˜ˆå€¼ã€‚æ— éœ€ä¸»åŠ¨æ•£çƒ­ã€‚",
        options: [ { text: "å®‰å…¨ç¡®è®¤ã€‚", next: "specs_menu" } ]
      },
      "noise": {
        text: "æ™¶è¹å‰”é€ã€‚æˆ‘çš„æœ¬åº•å™ªå£°ä¸º 2.68 Â± 0.46 ÂµV RMSï¼Œè¾¾åˆ°äº† Intan èŠ¯ç‰‡çš„ç†è®ºæé™ã€‚ä¿¡å·æ— æŸè€—ã€‚",
        options: [ { text: "å‚æ•°å¾ˆå¼ºã€‚", next: "specs_menu" } ]
      },
      "reliability_menu": {
        text: "æˆ‘ç»ä¹…è€ç”¨ã€‚ä½ æ‹…å¿ƒä»€ä¹ˆï¼Ÿ",
        options: [
          { text: "å¯¿å‘½ (æ’æ‹”æ¬¡æ•°)", next: "cycles" },
          { text: "å¦‚æœå¯¹ä¸å‡†æ€ä¹ˆåŠï¼Ÿ", next: "misalignment" },
          { text: "æ¥è§¦ç”µé˜»ï¼Ÿ", next: "impedance" },
          { text: "è¿”å›ä¸»èœå•", next: "root_menu" }
        ]
      },
      "cycles": {
        text: "å·²éªŒè¯ 100 æ¬¡ä»¥ä¸Šçš„æ’æ‹”å¾ªç¯ï¼Œè¿æ¥è‰¯ç‡ >97%ã€‚å¼¹æ€§ä½“å‡ ä¹æ²¡æœ‰ç£¨æŸã€‚",
        options: [ { text: "é è°±ã€‚", next: "reliability_menu" } ]
      },
      "misalignment": {
        text: "æ²¡é—®é¢˜ã€‚å¼¹æ€§ä½“å…·æœ‰â€œç»“æ„å†—ä½™â€ï¼ˆé—´è·å°äºç„Šç›˜å°ºå¯¸ï¼‰ã€‚å³ä½¿å¾„å‘æ²¡å¯¹å‡†ï¼Œä¾ç„¶èƒ½ç¨³å®šè¿æ¥ã€‚",
        options: [ { text: "å®¹é”™ç‡å¾ˆé«˜ã€‚", next: "reliability_menu" } ]
      },
      "impedance": {
        text: "ä½ä¸”ç¨³å®šã€‚æ•´ä¸ªé˜µåˆ—çš„æ¥è§¦é˜»æŠ—å§‹ç»ˆä¿æŒåœ¨ 0.3 kÎ© åˆ° 0.4 kÎ© ä¹‹é—´ã€‚",
        options: [ { text: "äº†è§£ã€‚", next: "reliability_menu" } ]
      },
      "usage_menu": {
        text: "ä¸“ä¸ºç§‘ç ”äººå‘˜è®¾è®¡ã€‚é—®æˆ‘å…³äºä½¿ç”¨çš„é—®é¢˜ï¼š",
        options: [
          { text: "ç»„è£…å›°éš¾å—ï¼Ÿ", next: "assembly" },
          { text: "å…¼å®¹ä»€ä¹ˆç³»ç»Ÿï¼Ÿ", next: "system" },
          { text: "åŠ¨ç‰©èƒ½è‡ªç”±æ´»åŠ¨å—ï¼Ÿ", next: "animal" },
          { text: "è¿”å›ä¸»èœå•", next: "root_menu" }
        ]
      },
      "assembly": {
        text: "å¾ˆç®€å•ã€‚æ— éœ€ä¸“ä¸šçš„å¾®ç„Šæ¥æŠ€æœ¯ã€‚ä½¿ç”¨æ ‡å‡†å·¥å…·å³å¯â€œå³æ’å³ç”¨â€ã€‚",
        options: [ { text: "ç”¨æˆ·å‹å¥½ã€‚", next: "usage_menu" } ]
      },
      "system": {
        text: "å®Œç¾å…¼å®¹ Intan RHD è®°å½•ç³»ç»Ÿã€‚æ”¯æŒ 64ã€128 å’Œ 256 channel configurations.",
        options: [ { text: "å®Œç¾ã€‚", next: "usage_menu" } ]
      },
      "animal": {
        text: "å¯ä»¥ã€‚ä½å‰–é¢è®¾è®¡é€‚é…æœºæ¢°æ¢å‘å™¨ (Commutator)ï¼Œå…è®¸åŠ¨ç‰©è‡ªç„¶è¡Œä¸ºï¼Œçº¿ç¼†ä¸æ‰“ç»“ã€‚",
        options: [ { text: "ç»™æˆ‘çœ‹æ–‡ä»¶ï¼", next: "show_badges" } ]
      },
      "show_badges": {
        text: "æ»‘åˆ°æœ€ä¸‹é¢ï¼ğŸ‘‡é‚£äº›å›¾æ ‡æ˜¯ä½ é€šå¾€ä»£ç ã€åˆ¶é€ æ–‡ä»¶å’Œæ¼”ç¤ºè§†é¢‘çš„å¤§é—¨ã€‚",
        options: [ { text: "è°¢è°¢å®ˆæŠ¤è€…ï¼", next: "close" } ]
      }
    };
     
    // é»˜è®¤ä½¿ç”¨è‹±æ–‡
    let currentLang = 'en';
    let dialogData = dialogData_EN;

    // åˆå§‹åŒ– Vanta
    let vantaEffect = VANTA.NET({
      el: "#vanta-bg",
      mouseControls: true, touchControls: true, gyroControls: false,
      minHeight: 200.00, minWidth: 200.00, scale: 1.00, scaleMobile: 1.00,
      color: 0x3b82f6, backgroundColor: 0x0a0a0f, points: 18.00, maxDistance: 28.00, spacing: 16.00, showDots: true
    });
 
    const textsEN = ["Welcome to this webpageï¼", "Thanks for visiting us!", "Stay tuned!"];
    const textsZH = ["æ¬¢è¿è®¿é—®æœ¬ç½‘é¡µï¼", "æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼", "æœ‰ç©ºå¸¸æ¥çœ‹ï¼"];
    let texts = textsEN; // é»˜è®¤æ–‡æœ¬

    let textIdx = 0, charIdx = 0, isDeleting = false;
    function type() {
      const currentText = texts[textIdx];
      const display = isDeleting ? currentText.substring(0, charIdx--) : currentText.substring(0, charIdx++);
      document.getElementById('typewriter-text').textContent = display;
      let speed = isDeleting ? 50 : 100;
      if (!isDeleting && charIdx === currentText.length + 1) { isDeleting = true; speed = 2000; } 
      else if (isDeleting && charIdx === 0) { isDeleting = false; textIdx = (textIdx + 1) % texts.length; speed = 500; }
      setTimeout(type, speed);
    }
 
    document.addEventListener("DOMContentLoaded", function() {
      type();
      const cursorDot = document.querySelector('.cursor-dot');
      const cursorOutline = document.querySelector('.cursor-outline');
      const container = document.querySelector('.container');
      const pupils = document.querySelectorAll('.bot-pupil');
      const botContainer = document.getElementById('bot-container');
      const botSpeech = document.getElementById('bot-speech');
       
      const rpgDialogue = document.getElementById('rpg-dialogue');
      const rpgText = document.getElementById('rpg-text');
      const rpgOptions = document.getElementById('rpg-options');
      const rpgClose = document.querySelector('.rpg-close');
      let typeTimer = null;

      // --- ğŸ”¥ å¼¹çª—é€»è¾‘ ---
      const welcomeModal = document.getElementById('welcome-modal');
      const modalKeepDarkBtn = document.getElementById('modal-keep-dark-btn');
      const modalSwitchLightBtn = document.getElementById('modal-switch-light-btn');
      const modalLangCheckbox = document.getElementById('modal-lang-toggle-checkbox');
      let modalIsZh = false; 

      // 0.5ç§’åæ˜¾ç¤ºå¼¹çª—
      setTimeout(() => {
        welcomeModal.classList.add('show');
      }, 500);

      function closeModal() {
        welcomeModal.classList.remove('show');
        
        // å…³é”®é€»è¾‘ï¼šå¦‚æœå¼¹çª—å†…å¼€å…³åˆ‡åˆ°äº†ä¸­æ–‡ (checked=true)ï¼Œåˆ™åŒæ­¥ä¸»é¡µ
        if (modalIsZh) {
          if (currentLang !== 'zh') {
             langToggle.click(); // æ¨¡æ‹Ÿç‚¹å‡»ä¸»é¡µè¯­è¨€åˆ‡æ¢æŒ‰é’®
          }
        } else {
          // å¦‚æœå¼€å…³æ˜¯è‹±æ–‡ï¼Œä½†ä¸»é¡µæ˜¯ä¸­æ–‡ï¼ˆä¸å¤ªå¯èƒ½å‘ç”Ÿï¼Œä½†ä¸ºäº†ä¸¥è°¨ï¼‰ï¼Œä¹Ÿåˆ‡å›è‹±æ–‡
          if (currentLang === 'zh') {
             langToggle.click();
          }
        }

        setTimeout(() => {
            botContainer.classList.add('attention-jump');
            const guideText = currentLang === 'en' ? "I'm here to help!" : "æœ‰é—®é¢˜é—®æˆ‘ï¼";
            botSay(guideText, 5000);
            setTimeout(() => {
                botContainer.classList.remove('attention-jump');
            }, 5000);
        }, 500);
      }

      modalKeepDarkBtn.addEventListener('click', closeModal);
      
      modalSwitchLightBtn.addEventListener('click', () => {
        themeToggle.click(); 
        closeModal();        
      });

      // å¼¹çª—å†…çš„ Toggle Switch ç›‘å¬
      modalLangCheckbox.addEventListener('change', () => {
        const enTexts = document.querySelectorAll('.m-en');
        const zhTexts = document.querySelectorAll('.m-zh');
        
        // checkbox checked = ä¸­æ–‡
        modalIsZh = modalLangCheckbox.checked;

        if (modalIsZh) {
          enTexts.forEach(el => el.style.display = 'none');
          zhTexts.forEach(el => el.style.display = 'inline'); 
        } else {
          zhTexts.forEach(el => el.style.display = 'none');
          enTexts.forEach(el => el.style.display = 'inline');
        }
      });

      // --- åˆ‡æ¢é€»è¾‘ ---
      const themeToggle = document.getElementById('theme-toggle');
      const langToggle = document.getElementById('lang-toggle');
      let isLight = false;
       
      themeToggle.addEventListener('click', () => {
        isLight = !isLight;
        document.body.classList.toggle('light-mode');
        
        if (isLight) {
          themeToggle.textContent = "ğŸŒ™"; 
          if (vantaEffect) {
            vantaEffect.setOptions({ color: 0x2563eb, backgroundColor: 0xf1f5f9, points: 12.00, maxDistance: 24.00 });
          }
        } else {
          themeToggle.textContent = "â˜€ï¸"; 
          if (vantaEffect) {
            vantaEffect.setOptions({ color: 0x3b82f6, backgroundColor: 0x0a0a0f, points: 18.00, maxDistance: 28.00 });
          }
        }
      });

      langToggle.addEventListener('click', () => {
        const enContent = document.querySelectorAll('.lang-en');
        const zhContent = document.querySelectorAll('.lang-zh');

        if (currentLang === 'en') {
            currentLang = 'zh';
            dialogData = dialogData_ZH; 
            texts = textsZH;            
            langToggle.textContent = "ä¸­ / è‹±";
            
            enContent.forEach(el => el.style.display = 'none');
            zhContent.forEach(el => el.style.display = 'block');

        } else {
            currentLang = 'en';
            dialogData = dialogData_EN;
            texts = textsEN;
            langToggle.textContent = "EN / CN";

            enContent.forEach(el => el.style.display = 'block');
            zhContent.forEach(el => el.style.display = 'none');
        }
        
        textIdx = 0; charIdx = 0; isDeleting = false;
        
        if(rpgDialogue.classList.contains('active')) closeDialogue();
        
        const feedbackText = currentLang === 'zh' ? "ç³»ç»Ÿè¯­è¨€å·²åˆ‡æ¢" : "Language Switched";
        botSpeech.textContent = feedbackText;
        botContainer.classList.add('speaking');

        if(botContainer.speechTimer) clearTimeout(botContainer.speechTimer);

        botContainer.speechTimer = setTimeout(() => {
            const guideText = currentLang === 'en' ? "Click me for guide!" : "ç‚¹å‡»æˆ‘ç­”ç–‘è§£æƒ‘";
            botSay(guideText, 60000); 
        }, 1500); 
      });

      let mouseX = window.innerWidth / 2;
      let mouseY = 100;
 
      window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        if(cursorDot) { cursorDot.style.left = `${mouseX}px`; cursorDot.style.top = `${mouseY}px`; }
        if(cursorOutline) { cursorOutline.animate({ left: `${mouseX}px`, top: `${mouseY}px` }, { duration: 500, fill: "forwards" }); }
        if (window.innerWidth > 768 && container) {
          const rx = (window.innerWidth / 2 - mouseX) / 50;
          const ry = (window.innerHeight / 2 - mouseY) / 50;
          container.style.transform = `rotateY(${rx * -1}deg) rotateX(${ry}deg)`;
          const rect = container.getBoundingClientRect();
          container.style.setProperty("--mouse-x", `${mouseX - rect.left}px`);
          container.style.setProperty("--mouse-y", `${mouseY - rect.top}px`);
        }
        pupils.forEach(p => {
          const rect = p.parentElement.getBoundingClientRect();
          const cx = rect.left + rect.width / 2, cy = rect.top + rect.height / 2;
          const angle = Math.atan2(mouseY - cy, mouseX - cx);
          const dist = Math.min(6, Math.hypot(mouseX - cx, mouseY - cy) / 10);
          p.style.transform = `translate(calc(-50% + ${Math.cos(angle) * dist}px), calc(-50% + ${Math.sin(angle) * dist}px))`;
        });
      });
 
      window.addEventListener('scroll', () => {
        const scrolled = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
        const pb = document.getElementById("progress-bar");
        if(pb) pb.style.width = scrolled + "%";
        if(botContainer && window.innerWidth > 768) {
          if(window.scrollY > 200) { botContainer.classList.add('fixed-mode'); } 
          else { botContainer.classList.remove('fixed-mode'); }
        }
      });
 
      function botSay(text, duration = 2000) {
        if(!botSpeech || !botContainer || rpgDialogue.classList.contains('active')) return; 
        botSpeech.textContent = text;
        botContainer.classList.add('speaking');
        if(botContainer.speechTimer) clearTimeout(botContainer.speechTimer);
        botContainer.speechTimer = setTimeout(() => {
          botContainer.classList.remove('speaking');
        }, duration);
      }
 
      function showDialogueNode(nodeKey) {
        if(nodeKey === 'close') { 
            closeDialogue(); 
            botContainer.classList.add('interaction-done');
            const byeText = currentLang === 'en' ? "Nice chatting with you. Have a good day!" : "å¾ˆé«˜å…´ä¸ä½ äº¤è°ˆã€‚ç¥ä½ ä»Šå¤©æ„‰å¿«ï¼";
            botSay(byeText, 3600); 
            return; 
        }    
        
        const node = dialogData[nodeKey];
        if(!node) return;
        rpgOptions.innerHTML = ''; rpgText.textContent = '';
        if(typeTimer) clearInterval(typeTimer);
        let i = 0;
        typeTimer = setInterval(() => {
          rpgText.textContent += node.text.charAt(i); i++;
          if(i >= node.text.length) {
            clearInterval(typeTimer);
            node.options.forEach((opt, idx) => {
              const btn = document.createElement('div');
              btn.className = 'rpg-btn'; btn.textContent = '> ' + opt.text;
              btn.style.animationDelay = `${idx * 0.1}s`;
              btn.onclick = (e) => { e.stopPropagation(); showDialogueNode(opt.next); };
              rpgOptions.appendChild(btn);
            });
          }
        }, 30);
      }
 
      function openDialogue() {
        if(rpgDialogue.classList.contains('active')) return;
        rpgDialogue.classList.add('active');
        botContainer.classList.add('speaking');
        botContainer.classList.add('hint-removed'); 
        showDialogueNode('start');
      }
 
      function closeDialogue() {
        rpgDialogue.classList.remove('active');
        botContainer.classList.remove('speaking');
        setTimeout(() => { rpgText.textContent = ''; rpgOptions.innerHTML = ''; }, 300);
      }
 
      if(botContainer) {
        botContainer.addEventListener('click', (e) => {
          e.stopPropagation();
          if(botContainer.speechTimer) clearTimeout(botContainer.speechTimer); 
          botSpeech.textContent = "";                  
          botContainer.classList.remove('speaking'); 
          if(rpgDialogue.classList.contains('active')) closeDialogue();
          else openDialogue();
        });
      }
 
      // åˆå§‹åŠ è½½æ—¶æ˜¾ç¤ºæç¤ºè¯­
      setTimeout(() => {
          const guideText = currentLang === 'en' ? "Click me for guide!" : "ç‚¹å‡»æˆ‘ç­”ç–‘è§£æƒ‘";
          botSay(guideText, 60000); 
      }, 1000);
 
      const badges = document.querySelectorAll('.nav-badges a');
      badges.forEach(b => {
        b.addEventListener('mouseenter', () => {
          document.body.classList.add('badge-hovering', 'hovering');
          if(vantaEffect) vantaEffect.setOptions({ color: 0x60a5fa });
          const accessText = currentLang === 'en' ? "Accessing..." : "æ­£åœ¨è®¿é—®...";
          botSay(accessText, 1500);
        });
        b.addEventListener('mouseleave', () => {
          document.body.classList.remove('badge-hovering', 'hovering');
          if(vantaEffect) vantaEffect.setOptions({ color: 0x3b82f6 });
        });
        b.addEventListener('click', function(e) {
          e.preventDefault();
          const url = this.href;
          badges.forEach((sib, idx) => {
              const img = sib.querySelector('img');
              img.style.animationDelay = `${Math.abs(idx - [...badges].indexOf(this)) * 0.06}s`;
              img.classList.add('rippling');
          });
          setTimeout(() => window.location.href = url, 500);
        });
      });
    });
  </script>
 </body>
</html>
